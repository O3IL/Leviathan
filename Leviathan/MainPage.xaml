<Page
    x:Class="Leviathan.MainPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:Leviathan"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d"
    Background="{ThemeResource ApplicationPageBackgroundThemeBrush}">

                <controls:DropShadowPanel x:Name="Shadow1" VerticalAlignment="Top"
                                  Canvas.ZIndex="75"
                                  ShadowOpacity="0.3"
                                  OffsetX="0"
                                  OffsetY="1"
                                  Grid.Row="1"
                                  HorizontalAlignment="Stretch"
                                  HorizontalContentAlignment="Stretch">
                    <Frame x:Name="FrameTop" Background="{x:Bind VTSelector.CurrentItem.BackgroundAcrylicBrush2, Mode=OneWay}"  Visibility="Visible" VerticalAlignment="Top" Height="40" Grid.RowSpan="1"/>
                </controls:DropShadowPanel>

                <CommandBar  x:Name="CommandBar1" DefaultLabelPosition="Right" Canvas.ZIndex="75" IsOpen="False" HorizontalAlignment="Left" Grid.Row="1" Background="{x:Null}" VerticalAlignment="Top" Height="40" Margin="0,0,210,0">
                    <AppBarButton Width="Auto" MinWidth="40" LabelPosition="Collapsed" x:Name="CmdNew" x:Uid="CmdNew" Label="New" Click="CmdNew_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="New" x:Uid="CmdNewTooltip"/>
                        </ToolTipService.ToolTip>
                        <AppBarButton.Icon>
                            <FontIcon Glyph="&#xE7C3;"/>
                        </AppBarButton.Icon>
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="N" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton Width="Auto" MinWidth="40" LabelPosition="Collapsed" x:Name="CmdOpen" x:Uid="CmdOpen" Label="Open" Click="CmdOpen_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Open (Ctrl+O)" x:Uid="CmdOpenTooltip"/>
                        </ToolTipService.ToolTip>
                        <AppBarButton.Icon>
                            <FontIcon Glyph="&#xF12B;"/>
                        </AppBarButton.Icon>
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="O" />
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarButton Width="Auto" MinWidth="40" LabelPosition="Collapsed" x:Name="CmdSave" x:Uid="CmdSave" Label="Save" Icon="Save" Click="CmdSave_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Save (Ctrl+S)" x:Uid="CmdSaveTooltip"/>
                        </ToolTipService.ToolTip>
                        <AppBarButton.KeyboardAccelerators>
                            <KeyboardAccelerator 
                          Modifiers="Control" 
                           Key="S"/>
                        </AppBarButton.KeyboardAccelerators>
                    </AppBarButton>
                    <AppBarSeparator Visibility="{x:Bind q:Converter.HideIfNoFormatsButtonShow(QSetting.ShowFont, QSetting.ShowColor, QSetting.ShowEmoji), Mode=OneWay}"/>
                    <AppBarButton Visibility="{x:Bind QSetting.ShowFont, Mode=OneWay}" x:Name="FontDropdown" LabelPosition="Collapsed" Width="Auto">
                        <AppBarButton.Resources>
                            <winui:TeachingTip x:Name="FontOptionTip"
                                               Target="{x:Bind FontDropdown}"
                                               x:Uid="FontOptionTip"
                                               Closing="{x:Bind AcknowledgeTheChangeOfFontSelection}">
                            </winui:TeachingTip>
                        </AppBarButton.Resources>
                        <StackPanel Orientation="Horizontal" Padding="10,0,10,0">
                            <TextBlock Text="{x:Bind CurrentFontName, Mode=OneWay}" FontFamily="Segoe UI" Margin="0,0,10,0"/>
                            <FontIcon Glyph="&#xE70D;" FontSize="12"/>
                        </StackPanel>
                        <AppBarButton.Flyout>
                            <Flyout w10v1809:Placement="BottomEdgeAlignedLeft" Opened="OpenFontFlyout">
                                <Flyout.FlyoutPresenterStyle>
                                    <Style TargetType="FlyoutPresenter">
                                        <Setter Property="Padding" Value="0"/>
                                    </Style>
                                </Flyout.FlyoutPresenterStyle>
                                <ListView Width="250" Height="350"
                                          x:Name="FontListSelection"
                                          Background="{x:Bind VTSelector.CurrentItem.BackgroundAcrylicBrush2, Mode=OneWay}"
                                          ItemsSource="{x:Bind AllFonts, Mode=OneWay}"
                                          ItemTemplate="{StaticResource FontFamilyComboBoxItem}"
                                          CharacterReceived="TryToFindFont"
                                          SelectedItem="{x:Bind q:Converter.SelectionFromString(CurrentFontName, AllFonts), Mode=TwoWay, BindBack=BindBackFontSelection}"/>
                            </Flyout>
                        </AppBarButton.Flyout>
                    </AppBarButton>
                    <AppBarButton Width="40" LabelPosition="Collapsed" Visibility="{x:Bind QSetting.ShowColor, Mode=OneWay}">
                        <AppBarButton.Icon>
                            <FontIcon Glyph="&#xE790;"/>
                        </AppBarButton.Icon>
                        <AppBarButton.Flyout>
                            <Flyout AllowFocusOnInteraction="True">
                                <dialog:ColorSelection AllowDefault="False"
                                                       ColorSelectionChanged="ColorSelection_ColorSelectionChanged"/>
                            </Flyout>
                        </AppBarButton.Flyout>
                    </AppBarButton>
                    <AppBarButton LabelPosition="Collapsed" x:Name="Emoji" w10v1809:Visibility="{x:Bind QSetting.ShowEmoji, Mode=OneWay}" Width="40" Icon="Emoji2" Click="Emoji_Clicked">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Insert Emojis (Win + .)" x:Uid="Emoji"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarSeparator Visibility="{x:Bind q:Converter.HideIfNoBulletOptionsShow(QSetting.ShowBold, QSetting.ShowItalic, QSetting.ShowUnderline, QSetting.ShowStrikethroughOption, QSetting.ShowBullets), Mode=OneWay}"/>
                    <AppBarToggleButton LabelPosition="Collapsed" IsChecked="{x:Bind IsItBold, Mode=OneWay}" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowBold), Mode=OneWay}" x:Name="Bold" x:Uid="Bold"  Label="Bold"  Width="Auto" MinWidth="40" Click="Bold_Click" Icon="Bold" HorizontalAlignment="Stretch">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Bold (Ctrl+B)" x:Uid="BoldTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarToggleButton>
                    <AppBarToggleButton LabelPosition="Collapsed" IsChecked="{x:Bind IsItItalic, Mode=OneWay}" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowItalic), Mode=OneWay}" x:Name="Italic" x:Uid="Italic" Label="Italic" Width="Auto" MinWidth="40" Click="Italic_Click" Icon="Italic" HorizontalAlignment="Stretch">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Italic (Ctrl+I)" x:Uid="ItalicTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarToggleButton>
                    <AppBarToggleButton LabelPosition="Collapsed" IsChecked="{x:Bind IsItUnderline, Mode=OneWay}" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowUnderline), Mode=OneWay}" x:Name="Underline" x:Uid="Underline" Label="Underline" Width="Auto" MinWidth="40" Click="Underline_Click" Icon="Underline" HorizontalAlignment="Stretch">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Underline (Ctrl+U)" x:Uid="UnderlineTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarToggleButton>
                    <AppBarToggleButton LabelPosition="Collapsed" IsChecked="{x:Bind IsItStrikethrough, Mode=OneWay}" x:Name="Strikethrough" x:Uid="Strikethrough" Label="Strikethrough"  Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowStrikethroughOption), Mode=OneWay}" HorizontalAlignment="Stretch" VerticalAlignment="Center" Click="Strikethrough_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Strikethrough" x:Uid="StrikethroughTooltip"/>
                        </ToolTipService.ToolTip>
                        <AppBarToggleButton.Icon>
                            <FontIcon Margin="0,4,0,-3" FontFamily="/Assets/Font/Segoe MDL2 Modded.ttf#Segoe MDL2 Modded" Glyph="&#xE1B2;">
                                <FontIcon.RenderTransform>
                                    <ScaleTransform ScaleX="1.1" ScaleY="1.1"/>
                                </FontIcon.RenderTransform>
                            </FontIcon>
                        </AppBarToggleButton.Icon>
                    </AppBarToggleButton>
                    <AppBarToggleButton LabelPosition="Collapsed" IsChecked="{x:Bind IsUsingBulletList, Mode=OneWay}" x:Name="BulletList" x:Uid="BulletList" Label="Bullets"  Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowBullets), Mode=OneWay}" Icon="List" Click="BulletList_Click" HorizontalAlignment="Stretch">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Toggle Bullets" x:Uid="BulletListTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarToggleButton>
                    <AppBarSeparator/>
                    <AppBarButton LabelPosition="Collapsed" x:Name="Left" x:Uid="Left" Label="Left" Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowAlignLeft), Mode=OneWay}" Click="Left_Click" Icon="AlignLeft">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Align left (Ctrl+L)" x:Uid="LeftTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarButton LabelPosition="Collapsed" x:Name="Center" x:Uid="Center" Label="Center" Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowAlignCenter), Mode=OneWay}" Click="Center_Click" Icon="AlignCenter">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Align center (Ctrl+E)" x:Uid="CenterTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarButton LabelPosition="Collapsed" x:Name="Right" x:Uid="Right" Label="Right"  Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowAlignRight), Mode=OneWay}" Click="Right_Click" Icon="AlignRight">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Align right (Ctrl+R)" x:Uid="RightTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarButton LabelPosition="Collapsed" x:Name="Justify" x:Uid="Justify" Label="Justify" Width="Auto" MinWidth="40" Visibility="{x:Bind q:Converter.BoolToVisibility(QSetting.ShowAlignJustify), Mode=OneWay}" Click="Justify_Click" Background="{x:Null}">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Justify text (Ctrl+J)" x:Uid="JustifyTooltip"/>
                        </ToolTipService.ToolTip>
                        <AppBarButton.Icon>
                            <FontIcon FontFamily="/Assets/Font/FabExMDL2.ttf#Fabric External MDL2 Assets" Glyph=""/>
                        </AppBarButton.Icon>
                    </AppBarButton>
                    <AppBarSeparator x:Name="AlignSeparator" Visibility="{x:Bind q:Converter.HideIfNoAlignButtonShow(QSetting.ShowAlignLeft, QSetting.ShowAlignCenter, QSetting.ShowAlignRight, QSetting.ShowAlignJustify), Mode=OneWay}"/>
                    <AppBarButton LabelPosition="Collapsed" x:Name="SizeUp" x:Uid="SizeUp" Label="Size Up" Width="Auto" MinWidth="40" Click="SizeUp_Click" Icon="FontIncrease" Visibility="{x:Bind QSetting.ShowSizeUp, Mode=OneWay}">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Size Up" x:Uid="SizeUpTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarButton LabelPosition="Collapsed" x:Name="SizeDown" x:Uid="SizeDown" Label="Size Down"  Width="Auto" MinWidth="40" Click="SizeDown_Click" Icon="FontDecrease" Visibility="{x:Bind QSetting.ShowSizeDown, Mode=OneWay}">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Size Down" x:Uid="SizeDownTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarSeparator Width="32" Visibility="{x:Bind q:Converter.HideIfNoSizeButtonShow(QSetting.ShowSizeUp, QSetting.ShowSizeDown), Mode=OneWay}"/>
                    <AppBarButton Label="Customize" Width="Auto" MinWidth="32" x:Uid="Cmd_Customize" LabelPosition="Collapsed">
                        <AppBarButton.Icon>
                            <FontIcon Glyph="&#xE15E;" />
                        </AppBarButton.Icon>
                        <AppBarButton.Flyout>
                            <MenuFlyout x:Name="settingsFlyoutMenu" Closing="ClosingCustomizeFlyout">
                                <ToggleMenuFlyoutItem Text="Show fonts" Icon="Font" IsChecked="{x:Bind QSetting.ShowFont, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem Text="Show color" IsChecked="{x:Bind QSetting.ShowColor, Mode=TwoWay}">
                                    <ToggleMenuFlyoutItem.Icon>
                                        <FontIcon Glyph="&#xE2B1;"/>
                                    </ToggleMenuFlyoutItem.Icon>
                                </ToggleMenuFlyoutItem>
                                <ToggleMenuFlyoutItem Text="Show emoji" Icon="Emoji2" IsChecked="{x:Bind QSetting.ShowEmoji, Mode=TwoWay}"
                                                      Visibility="{x:Bind QSetting.NewerThanApril2018Update}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_Bold" Text="Show bold" Icon="Bold" IsChecked="{x:Bind QSetting.ShowBold, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_Italic" Text="Show italic" Icon="Italic" IsChecked="{x:Bind QSetting.ShowItalic, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_Underline" Text="Show underline" Icon="Underline" IsChecked="{x:Bind QSetting.ShowUnderline, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_Strikethrough" Text="Show Strikethrough" IsChecked="{x:Bind QSetting.ShowStrikethroughOption, Mode=TwoWay}">
                                    <ToggleMenuFlyoutItem.Icon>
                                        <FontIcon Margin="0,4,0,-3" FontFamily="/Assets/Font/Segoe MDL2 Modded.ttf#Segoe MDL2 Modded" Glyph="&#xE1B2;">
                                            <FontIcon.RenderTransform>
                                                <ScaleTransform ScaleX="1.1" ScaleY="1.1"/>
                                            </FontIcon.RenderTransform>
                                        </FontIcon>
                                    </ToggleMenuFlyoutItem.Icon>
                                </ToggleMenuFlyoutItem>
                                <ToggleMenuFlyoutItem x:Uid="Customize_Bullets" Text="Show bullet list" Icon="List" IsChecked="{x:Bind QSetting.ShowBullets, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_AlignLeft" Text="Show align left" Icon="AlignLeft" IsChecked="{x:Bind QSetting.ShowAlignLeft, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_AlignCenter" Text="Show align center" Icon="AlignLeft" IsChecked="{x:Bind QSetting.ShowAlignCenter, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_AlignRight" Text="Show align right" Icon="AlignRight" IsChecked="{x:Bind QSetting.ShowAlignRight, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_AlignJustify" Text="Show align justify" IsChecked="{x:Bind QSetting.ShowAlignJustify, Mode=TwoWay}">
                                    <ToggleMenuFlyoutItem.Icon>
                                        <FontIcon Margin="0,5,0,0" FontFamily="/Assets/Font/Segoe MDL2 Modded.ttf#Segoe MDL2 Modded" Glyph="&#xE1A2;">
                                            <FontIcon.RenderTransform>
                                                <ScaleTransform ScaleX="1.4" ScaleY="1.4"/>
                                            </FontIcon.RenderTransform>
                                        </FontIcon>
                                    </ToggleMenuFlyoutItem.Icon>
                                </ToggleMenuFlyoutItem>
                                <ToggleMenuFlyoutItem x:Uid="Customize_SizeUp" Text="Show size up" Icon="FontIncrease" IsChecked="{x:Bind QSetting.ShowSizeUp, Mode=TwoWay}"/>
                                <ToggleMenuFlyoutItem x:Uid="Customize_SizeDown" Text="Show size down" Icon="FontDecrease" IsChecked="{x:Bind QSetting.ShowSizeDown, Mode=TwoWay}"/>
                                <MenuFlyoutSeparator/>
                                <MenuFlyoutItem x:Uid="Customize_Reset" Text="Reset toolbar" Icon="Sync" Click="{x:Bind ResetToolbarSetting}"/>
                            </MenuFlyout>
                        </AppBarButton.Flyout>
                    </AppBarButton>
                </CommandBar>

                <CommandBar x:Name="CommandBar2" DefaultLabelPosition="Collapsed" Canvas.ZIndex="75" IsOpen="False" HorizontalAlignment="Right" Grid.Row="1" VerticalAlignment="Top" Height="40" Background="{x:Bind VTSelector.CurrentItem.BackgroundAcrylicBrush2, Mode=OneWay}">
                    <CommandBar.SecondaryCommands>
                        <AppBarButton x:Name="CmdFocusMode" x:Uid="CmdFocusMode" Click="{x:Bind SwitchingFocusMode}" Icon="Caption" Label="Focus Mode" Width="Auto"/>
                        <AppBarButton x:Name="CmdClassicMode" Click="{x:Bind SwitchingClassicAndDefault}" Label="Classic Mode" x:Uid="CmdClassicMode" Width="Auto">
                            <AppBarButton.Icon>
                                <FontIcon Glyph="&#xE8C5;" />
                            </AppBarButton.Icon>
                        </AppBarButton>
                        <AppBarButton x:Name="CmdStatusBar" Click="{x:Bind SwitchingStatusBarDisplay}" Label="Status bar">
                            <AppBarButton.Icon>
                                <FontIcon Glyph="&#xE75B;" />
                            </AppBarButton.Icon>
                        </AppBarButton>
                        <AppBarButton x:Name="CmdShare" x:Uid="CmdShare" Label="Share"  Width="Auto" MinWidth="40" Icon="Share" Click="CmdShare_Click" >
                            <ToolTipService.ToolTip>
                                <TextBlock Text="Share the file you are working on." x:Uid="CmdShareTooltip"/>
                            </ToolTipService.ToolTip>
                        </AppBarButton>
                        <AppBarButton Icon="Find" x:Uid="CmdFind" Width="Auto" MinWidth="40" Click="{x:Bind ToggleFindAndReplaceDialog}" Visibility="{x:Bind q:Converter.BoolToVisibilityInvert(CompactOverlaySwitch), Mode=OneWay}">
                            <AppBarButton.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="F" />
                            </AppBarButton.KeyboardAccelerators>
                        </AppBarButton>
                        <AppBarButton x:Name="CmdSettings" x:Uid="CmdSettings" Icon="Setting" Label="Settings" Width="Auto" Visibility="Visible" Click="CmdSettings_Click">
                            <ToolTipService.ToolTip>
                                <TextBlock Text="Settings" x:Uid="CmdSettingsTooltip"/>
                            </ToolTipService.ToolTip>
                        </AppBarButton>
                        <AppBarButton Icon="Cancel" Label="Exit" Width="Auto" Click="CmdExit_Click" x:Uid="CmdExit">
                            <ToolTipService.ToolTip>
                                <TextBlock Text="Exit the app" x:Uid="CmdExitTooltip"/>
                            </ToolTipService.ToolTip>
                        </AppBarButton>
                    </CommandBar.SecondaryCommands>
                    <AppBarButton x:Name="CmdUndo" IsEnabled="{x:Bind CanUndoText, Mode=OneWay}" Label="Undo" x:Uid="CmdUndo" Width="Auto" MinWidth="40" Icon="Undo" Visibility="Visible"  Click="CmdUndo_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Undo (Ctrl+Z)" x:Uid="CmdUndoTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarButton x:Name="CmdRedo" IsEnabled="{x:Bind CanRedoText, Mode=OneWay}" Label="Redo" x:Uid="CmdRedo" Width="Auto" MinWidth="40" Icon="Redo" Visibility="Visible" Click="CmdRedo_Click">
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Redo (Ctrl+Y)" x:Uid="CmdRedoTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                    <AppBarSeparator x:Name="ASep1"/>
                    <AppBarButton x:Uid="CompactOverlay" Click="{x:Bind SwitchingOverlayMode}" MinWidth="40" Width="Auto">
                        <AppBarButton.Icon>
                            <FontIcon Glyph="&#xEE49;" FontFamily="/Assets/Font/CalcMDL2.ttf#Calculator MDL2 Assets"/>
                        </AppBarButton.Icon>
                        <ToolTipService.ToolTip>
                            <TextBlock Text="Compact Overlay (Alt + Up)" x:Uid="CmdCompactOverlayTooltip"/>
                        </ToolTipService.ToolTip>
                    </AppBarButton>
                </CommandBar>

                <winui:MenuBar x:Name="CommandBarClassic" Canvas.ZIndex="75" HorizontalAlignment="Left" Grid.Row="1" VerticalAlignment="Top" Height="40" Background="{x:Null}"  Visibility="{x:Bind q:Converter.BoolToVisibility(ClassicModeSwitch), Mode=OneWay}">
                    <winui:MenuBarItem Title="File" AccessKey="F" x:Uid="ClassicFile">
                        <MenuFlyoutItem Text="New" AccessKey="N" Click="CmdNew_Click" x:Uid="ClassicFileNew">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE7C3;"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="N" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Open" Click="CmdOpen_Click" AccessKey="O" x:Uid="ClassicFileOpen">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xF12B;"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="O" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Save" Click="CmdSave_Click" AccessKey="S" x:Uid="ClassicFileSave">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Save"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="S" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Save As..." Click="CmdSaveAs_Click" AccessKey="A" x:Uid="ClassicFileSaveAs">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Save"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control, Shift" 
                           Key="S" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Share" Click="CmdShare_Click" AccessKey="H" x:Uid="ClassicFileShare">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Share"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Exit" Click="CmdExit_Click" AccessKey="X" x:Uid="ClassicFileExit">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE8BB;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </winui:MenuBarItem>
                    <winui:MenuBarItem Title="Edit" AccessKey="E" x:Uid="ClassicEdit">
                        <MenuFlyoutItem Text="Undo" Click="CmdUndo_Click" AccessKey="U" x:Uid="ClassicEditUndo" IsEnabled="{x:Bind CanUndoText, Mode=OneWay}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Undo"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Redo" AccessKey="E" Click="CmdRedo_Click" x:Uid="ClassicEditRedo" IsEnabled="{x:Bind CanRedoText, Mode=OneWay}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Redo"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Cut" Click="Cut_Click" AccessKey="T" x:Uid="ClassicEditCut"
                                  IsEnabled="{x:Bind q:Converter.CompareNumber(SelectionLength, '>', 0), Mode=OneWay}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Cut"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Copy" Click="Copy_Click" AccessKey="C" x:Uid="ClassicEditCopy"
                                  IsEnabled="{x:Bind q:Converter.CompareNumber(SelectionLength, '>', 0), Mode=OneWay}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Copy"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem IsEnabled="{x:Bind CanPasteText, Mode=OneWay}" Text="Paste" Click="Paste_Click" AccessKey="P" x:Uid="ClassicEditPaste">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Paste"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Delete" Click="Delete_Click" AccessKey="L" x:Uid="ClassicEditDelete"
                                  IsEnabled="{x:Bind q:Converter.CompareNumber(SelectionLength, '>', 0), Mode=OneWay}">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Delete"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Search with Bing..." AccessKey="S" Click="{x:Bind FindWithBing}" x:Uid="ClassicEditSearch">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE12B;" />
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="E" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Uid="ClassicEditFind" AccessKey="F" Text="Find" Icon="Find" Click="{x:Bind ToggleFindAndReplaceDialog}">
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="F" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Uid="ClassicEditFindNext" AccessKey="N" Text="Find Next" Click="{x:Bind FindAndReplaceDialog.RequestFindNext}">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE0AB;" />
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="F3" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Uid="ClassicEditFindPrevious" AccessKey="V" Text="Find Previous" Click="{x:Bind FindAndReplaceDialog.RequestFindPrevious}">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE0A6;" />
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Shift" Key="F3" />
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem x:Uid="ClassicEditReplace" AccessKey="R" Text="Replace" Icon="Rename" Click="{x:Bind OpenFindDialogWithReplace}">
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Control" Key="H"/>
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Go To" AccessKey="G" Click="{x:Bind CMDGoTo_Click}" x:Uid="ClassicEditGoTo">
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Modifiers="Control" Key="G"/>
                            </MenuFlyoutItem.KeyboardAccelerators>
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE12F;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Select All" AccessKey="A" Click="CMDSelectAll_Click" x:Uid="ClassicEditSelectAll">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE8B3;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Date/Time" AccessKey="D" Click="CMDInsertDateTime_Click" x:Uid="ClassicEditInsertDT">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xEC92;"/>
                            </MenuFlyoutItem.Icon>
                            <MenuFlyoutItem.KeyboardAccelerators>
                                <KeyboardAccelerator Key="F5"/>
                            </MenuFlyoutItem.KeyboardAccelerators>
                        </MenuFlyoutItem>
                    </winui:MenuBarItem>
                    <winui:MenuBarItem Title="Format" AccessKey="O" x:Uid="ClassicFormat">
                        <ToggleMenuFlyoutItem Text="Word Wrap" x:Name="WordWrap" IsChecked="{x:Bind QSetting.WordWrap, Mode=TwoWay}" x:Uid="WordWrap">
                            <ToggleMenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE751;"/>
                            </ToggleMenuFlyoutItem.Icon>
                        </ToggleMenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Fonts..." AccessKey="F" Click="ShowFontsDialog_Click" x:Uid="ClassicFormatFonts">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Font"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </winui:MenuBarItem>
                    <winui:MenuBarItem Title="View" AccessKey="V" x:Uid="ClassicView">
                        <MenuFlyoutItem Text="Back to default mode" AccessKey="D" Click="{x:Bind SwitchingClassicAndDefault}" x:Uid="ClassicViewBack">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Back"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Focus Mode" AccessKey="F" Click="{x:Bind SwitchingFocusMode}" x:Uid="ClassicViewFocus">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Caption"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutItem Text="Overlay mode" AccessKey="O" Click="{x:Bind SwitchingOverlayMode}" x:Uid="ClassicViewOverlay">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xEE49;" FontFamily="/Assets/Font/CalcMDL2.ttf#Calculator MDL2 Assets"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutSubItem Text="Zoom" x:Uid="ClassicZoom" AccessKey="Z">
                            <MenuFlyoutSubItem.Icon>
                                <FontIcon Glyph="&#xE92D;"/>
                            </MenuFlyoutSubItem.Icon>
                            <MenuFlyoutItem Text="Zoom In" Click="ZoomIn" x:Uid="ClassicZoomIn" AccessKey="I">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE8A3;"/>
                                </MenuFlyoutItem.Icon>
                                <MenuFlyoutItem.KeyboardAccelerators>
                                    <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="Add"/>
                                </MenuFlyoutItem.KeyboardAccelerators>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Text="Zoom Out" Click="ZoomOut" x:Uid="ClassicZoomOut" AccessKey="O">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE71F;"/>
                                </MenuFlyoutItem.Icon>
                                <MenuFlyoutItem.KeyboardAccelerators>
                                    <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="Subtract"/>
                                </MenuFlyoutItem.KeyboardAccelerators>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Text="Restore Default Zoom" Click="ResetZoom" x:Uid="ClassicRestoreDefaultZoom" AccessKey="R">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE71E;"/>
                                </MenuFlyoutItem.Icon>
                                <MenuFlyoutItem.KeyboardAccelerators>
                                    <KeyboardAccelerator
                          Modifiers="Control" 
                           Key="Number0" />
                                </MenuFlyoutItem.KeyboardAccelerators>
                            </MenuFlyoutItem>
                        </MenuFlyoutSubItem>
                        <ToggleMenuFlyoutItem Text="Status Bar" AccessKey="S" IsChecked="{x:Bind QSetting.ShowStatusBar, Mode=TwoWay}" x:Uid="ClassicViewStatusBar">
                            <ToggleMenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE75B;" />
                            </ToggleMenuFlyoutItem.Icon>
                        </ToggleMenuFlyoutItem>
                    </winui:MenuBarItem>
                    <winui:MenuBarItem Title="Help" AccessKey="H" x:Uid="ClassicHelp">
                        <MenuFlyoutItem Text="Settings" AccessKey="S" Click="CmdSettings_Click" x:Uid="CmdSettingsTooltip">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="Setting"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Rate and Review" AccessKey="R" Click="CmdReview_Click" x:Uid="ClassicHelpRR">
                            <MenuFlyoutItem.Icon>
                                <SymbolIcon Symbol="SolidStar"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </winui:MenuBarItem>
                </winui:MenuBar>

                <dialog:FindAndReplace Grid.Row="2" VerticalAlignment="Top" HorizontalAlignment="Right" Margin="10"  Visibility="{x:Bind q:Converter.BoolToVisibility(ShowFindAndReplace), Mode=OneWay}" Canvas.ZIndex="90" x:Name="FindAndReplaceDialog"/>
                <ScrollViewer x:Name="ScrollZoom" ZoomMode="Enabled" Grid.Row="2"  HorizontalAlignment="Stretch" VerticalAlignment="Stretch" MaxZoomFactor="4" HorizontalScrollMode="Enabled" VerticalScrollMode="Enabled" HorizontalScrollBarVisibility="Visible">
                    <RichEditBox Grid.Row="2" 
                     x:Name="Text1" 
                     x:FieldModifier="public"
                     Drop="Text1_Drop" 
                     SelectionChanged="Text1_SelectionChanged" 
                     DragOver="Text1_DragOver" 
                     KeyDown="Text1_KeyDown" 
                     PreviewKeyDown="Text1_KeyDown"
                     TextChanged="Text1_TextChanged" 
                     TextChanging="Text1_TextChanging"
                     GotFocus="Text1_GotFocus" 
                     BorderThickness="0,0,0,0" 
                     HorizontalAlignment="Stretch" 
                     VerticalAlignment="Stretch" 
                     TextWrapping="{x:Bind q:Converter.BoolToTextWrap(QSetting.WordWrap), Mode=OneWay}" 
                     IsSpellCheckEnabled="{x:Bind QSetting.SpellCheck, Mode=OneWay}" 
                     Style="{StaticResource RichEditBox}"
                     Background="{x:Bind q:Converter.SelectionBetweenBrush(QSetting.PreventText1ChangeColor, VTSelector.CurrentItem.BackgroundAcrylicBrush, VTSelector.CurrentItem.BaseThemeBackgroundBrush), Mode=OneWay}" 
                     IsTapEnabled="True"
                     FontSize="{x:Bind QSetting.DefaultFontSize, Mode=OneWay}"
                     Tapped="Text1_Tapped" FontFamily="Consolas">
                        <RichEditBox.SelectionHighlightColorWhenNotFocused>
                            <SolidColorBrush Color="{StaticResource SystemAccentColor}"/>
                        </RichEditBox.SelectionHighlightColorWhenNotFocused>
                    </RichEditBox>
                </ScrollViewer>

                <controls:DropShadowPanel Grid.Row="3"
                                          x:Name="StatusBarShadow"
                                  VerticalAlignment="Bottom"
                                  Canvas.ZIndex="10"
                                  ShadowOpacity="0.2"
                                  OffsetX="0"
                                  OffsetY="-1"
                                  HorizontalAlignment="Stretch"
                                  HorizontalContentAlignment="Stretch"
                                  Visibility="{x:Bind q:Converter.CanIShowStatusBar(ClassicModeSwitch, FocusModeSwitch, CompactOverlaySwitch, QSetting.ShowStatusBar), Mode=OneWay}">
                    <Grid Canvas.ZIndex="74" HorizontalAlignment="Stretch" Background="{x:Bind VTSelector.CurrentItem.BackgroundAcrylicBrush2, Mode=OneWay}"  Grid.Row="3" VerticalAlignment="Stretch" x:Name="StatusBar" MinHeight="25">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <!--Save status-->
                        <Grid Margin="5,0,2,0" Visibility="{x:Bind q:Converter.ShowIfItemIsNotNull(CurrentWorkingFile), Mode=OneWay}" Width="32" MaxWidth="32" x:Name="SaveIconStatus">
                            <FontIcon Glyph="&#xE74E;" FontSize="11" Grid.Column="1" Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}">
                                <ToolTipService.ToolTip>
                                    <StackPanel>
                                        <TextBlock Text="{x:Bind CurrentWorkingFile.StorageFile.Path, Mode=OneWay}"/>
                                    </StackPanel>
                                </ToolTipService.ToolTip>
                            </FontIcon>
                            <Ellipse Width="6" Height="6" Fill="Red" HorizontalAlignment="Left" Margin="8,0,0,8" Visibility="{x:Bind q:Converter.BoolToVisibility(Changed), Mode=OneWay}"/>
                        </Grid>
                        <!--Line and character count-->
                        <TextBlock VerticalAlignment="Center" HorizontalAlignment="Right" Padding="5,0,10,0" FontSize="11" Grid.Column="2" Margin="0,0,5,0" Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}">
                <Run Text="Ln: " x:Uid="StatusLnCount"/><Run Text="{x:Bind CurrentLine, Mode=OneWay}"/><Run Text=","/>
                <Run Text="Col: " x:Uid="StatusColCount"/><Run Text="{x:Bind CurrentPosition, Mode=OneWay}"/>
                        </TextBlock>

                        <TextBlock HorizontalAlignment="Right" VerticalAlignment="Center" FontSize="11" Grid.Column="4" Margin="0,0,15,0" Foreground="{ThemeResource SystemControlForegroundBaseMediumHighBrush}">
                            <Run Text="{x:Bind CurrentEncoding, Mode=OneWay}"/>
                        </TextBlock>
                    </Grid>
                </controls:DropShadowPanel>

                <Grid x:Name="trickyTitleBar" Grid.Row="0" Canvas.ZIndex="1000" Background="Transparent" Height="33" VerticalAlignment="Top"/>

    </Grid>
</Page>
